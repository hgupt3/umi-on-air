<?xml version="1.0" encoding="utf-8"?>
<mujoco model="umi_mocap">
    <option timestep="0.02" gravity="0 0 0"/>
    <compiler meshdir="./meshes" angle="radian" autolimits="true"/>

    <!-- assets -->
    <asset>
        <texture name="grid" type="2d" builtin="checker"
                 rgb1=".1 .2 .3" rgb2=".2 .3 .4"
                 width="512" height="512" mark="edge" markrgb=".2 .3 .4"/>
        <material name="grid" texture="grid" texrepeat="1 1" texuniform="true"/>
        <mesh name="gripper_base_mesh"      file="v2_arm_gripper.stl"            scale="0.001 0.001 0.001"/>
        <mesh name="gripper_fingertip_mesh" file="v2_gripper_long_fingertip.stl" scale="0.001 0.001 0.001"/>
    </asset>

    <worldbody>
        <geom name="ground" type="plane" pos="0 0 -0.5" size="10 10 .1" material="grid"/>
        <light name="light_top" pos="0 0 35" dir="0 0 -1" diffuse="1 1 1" specular="0.5 0.5 0.5"/>

        <!-- mocap body that you move each step -->
        <body name="umi_mocap" pos="0.0 0.0 0.0" quat="1 0 0 0" mocap="true"/>

        <body name="base_link" pos="0.0 0.0 0.0" quat="1 0 0 0">
            <freejoint name="base_freejoint"/>
            <inertial pos="0 0 0" mass="0.1" diaginertia="0.001 0.001 0.001"/>

            <!-- 90-degree pitch wrapper -->
            <body name="pitch90" pos="0 0 0" quat="0.707 0.707 0 0">
                <body name="ee" pos="0 0 0" quat="1 0 0 0">
                    <inertial pos="0 0 0" mass="0.0001" diaginertia="0.0001 0.0001 0.0001"/>

                    <body name="gripper_base_link" pos="0 0 0" quat="1 0 0 0">
                        <geom name="gripper_base_geom" type="mesh"
                              mesh="gripper_base_mesh" mass="0.1"/>

                        <!-- left finger -->
                        <body name="lfinger_link" pos="0.08 0 0" quat="0.707 0.707 0 0">
                            <joint name="lfinger_slide" type="slide" axis="0 1 0"
                                   range="0.001 0.06" damping="0.01"/>
                            <geom name="lfinger_geom" type="mesh"
                                  mesh="gripper_fingertip_mesh" mass="0.1"/>
                        </body>

                        <!-- right finger -->
                        <body name="rfinger_link" pos="0.08 0 0" quat="0.707 -0.707 0 0">
                            <joint name="rfinger_slide" type="slide" axis="0 1 0"
                                   range="0.001 0.06" damping="0.01"/>
                            <geom name="rfinger_geom" type="mesh"
                                  mesh="gripper_fingertip_mesh" mass="0.1"/>
                        </body>
                    </body>

                    <!-- EE camera -->
                    <camera name="ee" mode="fixed" pos="0.05 0.05 0"
                            axisangle="0 1 0 -1.57" fovy="90"/>
                </body>
            </body>
        </body>
    </worldbody>

    <!-- weld mocap to base_link -->
    <equality>
        <weld body1="umi_mocap" body2="base_link" solref="0.001 1"/>
    </equality>

    <!-- actuators: two finger slides -->
    <!-- <actuator>
        <position name="lfinger_motor" joint="lfinger_slide" ctrlrange="-1 1"/>
        <position name="rfinger_motor" joint="rfinger_slide" ctrlrange="-1 1"/>
    </actuator> -->

    <actuator>
        <position name="lfinger_servo"
            joint="lfinger_slide"
            ctrlrange="0 0.06"
            kp="35" kv="0.5"/>

        <position name="rfinger_servo"
            joint="rfinger_slide"
            ctrlrange="0 0.06"
            kp="35" kv="0.5"/>
    </actuator>
</mujoco>
